# Nexign Bootcamp Task
## Описание задания
Файл **CDR (Call Data Record)** собирается на коммутаторе - оборудовании, обрабатывающем звонки.

Этот файл содержит следующую обязательную информацию:

- тип вызова (01 - исходящие, 02 - входящие)
- номер абонента
- дата и время начала звонка (YYYYMMDDHH24MMSS)
- дата и время окончания звонка

Вот пример готовой записи **cdr**:

02,79876543221,20230321160455,20230321163211

**CDR** принимает **BRT (Billing Real Time)**.

Получив данные из **CDR BRT** авторизует абонентов оператора "Ромашка", чей баланс больше 0.

Для этого BRT связывается с базой клиентов в которойесть информация о абоненте: номер, тариф, баланс.

Тарифов всего 4:

- (06) Безлимит 300: 300 минут - за тарифный период стоят фиксированную сумму - 100р. Каждая последующая минута - 1р.
- (03) Поминутный: 1 минута разговора - 1.5 рубля.
- (11) Обычный: Входящие - бесплатно, исходящие - первые 100 минут по 0.5р/минута, после по тарифу "поминутный".
- (82) Тариф Х: Исходящие и входящие звонки абонентам оператора Ромашка - бесплатно. Всем остальным - расчет по тарифу "поминутный".

После авторизации **BRT** генерирует файл **CDR+**, который содержит уже информацию о тарифе абонента и передает его в **HRS (High performance rating server)**.

HRS считает сколько денег нужно списать со счета абонента, исходя из длительности его разговоров и выбранного тарифа и возвращает данные в **BRT**, который вносит изменения в базу и меняет баланс пользователя на соответствующую сумму.

Есть **CRM** система, в которой есть два уровня прав: **менеджер и абонент**.

- **Абонент** может пополнить счет и получить детализацию звонков.
- **Менеджер** может сменить тариф, создать нового пользователя и выполнять тарификацию.

## Описание решения

Решение представляет из себя многомодульный проект с использованием брокера сообщений.

### Используемые технологии:

- Java 17
- Spring Boot 3
- PostgreSQL
- ActiveMQ Artemis

### Проект состоит из следующих модулей:

- **cdr**: генерация CDR и оправление в **BRT**
- **brt**: авторизация абонентов Ромашки, генерация CDR+ и отправка в **HRS**
- **hrs**: расчет вызовов по тарифам абонентов и отправка данных обратно в **BRT**
- **crm**: модуль для управления системой
- **common**: модуль, содержащий общие типы и бины

### Схема базы данных:

### Тарификатор:
